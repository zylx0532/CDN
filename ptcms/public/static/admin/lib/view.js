/** PTNovelSearch-v4.1.2 LPPL License By https://www.zhiqiang.name/ */
 ;layui.define(["laytpl","layer"],function(e){var t=layui.jquery,n=layui.laytpl,a=layui.layer,r=layui.setter,o=(layui.device(),layui.hint()),i=function(e){return new d(e)},s="LAY_app_body",d=function(e){this.id=e,this.container=t("#"+(e||s))};i.loading=function(e){e.append(this.elemLoad=t('<i class="layui-anim layui-anim-rotate layui-anim-loop layui-icon layui-icon-loading layadmin-loading"></i>'))},i.removeLoad=function(){this.elemLoad&&this.elemLoad.remove()},i.exit=function(){layui.data(r.tableName,{key:r.request.tokenName,remove:!0}),location.hash="/user/login"},i.req=function(e){var n=null,o=e.success,s=(e.error,r.request),d=r.response,l=function(){return r.debug?"<br><cite>URL：</cite>"+e.url:""};if("undefined"==typeof e.beforeSend&&(e.beforeSend=function(){null===n&&(n=a.load(1,{shade:[.1,"#000"]}))}),"undefined"==typeof e.complete&&(e.complete=function(){null!==n&&(a.close(n),n=null)}),e.data=e.data||{},e.headers=e.headers||{},s.tokenName){var u="string"==typeof e.data?JSON.parse(e.data):e.data;e.data[s.tokenName]=s.tokenName in u?e.data[s.tokenName]:layui.data(r.tableName)[s.tokenName]||"",e.headers[s.tokenName]=s.tokenName in e.headers?e.headers[s.tokenName]:layui.data(r.tableName)[s.tokenName]||""}return delete e.success,delete e.error,t.ajax(t.extend({type:"get",dataType:"json",success:function(t){t.access_token&&layui.data(r.tableName,{key:r.request.tokenName,value:t.access_token});var n=d.statusCode;if(t[d.statusName]===n.ok)"function"==typeof e.done&&e.done(t),"function"==typeof o&&o(t);else if(t[d.statusName]===n.logout)i.exit();else if(t[d.statusName]===n.dataValidateFail){var a="";if("object"==typeof t[d.dataName].__errors){var s={};"object"==typeof config.fields&&layui.each(config.fields,function(e,t){t.key&&(s[t.key]=t.name)}),a=[],layui.each(t[d.dataName].__errors,function(e,t){a.push(("undefined"==typeof s[e]?e:s[e])+" "+t)}),a=a.join("<br>")}else a=t[d.msgName]||"返回状态码异常";i.error(a)}else{var a=t[d.msgName]||"返回状态码异常";i.error(a)}},error:function(e,t){var n=["请求异常，请重试<br><cite>错误信息：</cite>"+t,l()].join("");i.error(n),"function"==typeof n&&n(res)}},e))},i.popup=function(e){var n=e.success,r=e.skin;return delete e.success,delete e.skin,a.open(t.extend({type:1,title:"提示",content:"",id:"LAY-system-view-popup",skin:"layui-layer-admin"+(r?" "+r:""),shadeClose:!0,closeBtn:!1,success:function(e,r){var o=t('<i class="layui-icon" close>&#x1006;</i>');e.append(o),o.on("click",function(){a.close(r)}),"function"==typeof n&&n.apply(this,arguments)}},e))},i.error=function(e,n){return a.open(t.extend({title:"温馨提示",content:e,maxWidth:400,icon:2,anim:6,id:"LAY_adminError",btn:["我知道了"]},n))},i.success=function(e,n){var r=layui.router().path[layui.router().path.length-1];return a.open(t.extend({title:"操作成功",content:e,maxWidth:500,icon:1,id:"LAY_adminSuccess",btn:["add"===r?"继续添加":"确定","返回列表"]},n))},i.tip=function(e,n){return a.open(t.extend({title:"操作成功",content:e,maxWidth:500,id:"LAY_adminTip",time:3e3},n))},d.prototype.render=function(e,n){var a=this;layui.router();return e=r.views+e+r.engine,t("#"+s).children(".layadmin-loading").remove(),i.loading(a.container),t.ajax({url:e,type:"get",dataType:"html",data:{v:layui.cache.version},success:function(e){e="<div>"+e+"</div>";var r=t(e).find("title"),o=r.text()||(e.match(/\<title\>([\s\S]*)\<\/title>/)||[])[1],s={title:o,body:e};r.remove(),a.params=n||{},a.then&&(a.then(s),delete a.then),a.parse(e),i.removeLoad(),a.done&&(a.done(s),delete a.done)},error:function(e){return i.removeLoad(),a.render.isError?i.error("请求视图文件异常，状态："+e.status):(404===e.status?a.render("template/tips/404"):a.render("template/tips/error"),void(a.render.isError=!0))}}),a},d.prototype.parse=function(e,a,r){var s=this,d="object"==typeof e,l=d?e:t(e),u=d?e:l.find("*[template]"),c=function(e){var a=n(e.dataElem.html()),o=t.extend({params:y.params},e.res);e.dataElem.after(a.render(o)),"function"==typeof r&&r();try{e.done&&new Function("d",e.done)(o)}catch(i){console.error(e.dataElem[0],"\n存在错误回调脚本\n\n",i)}},y=layui.router();l.find("title").remove(),s.container[a?"after":"html"](l.children()),y.params=s.params||{};for(var p=u.length;p>0;p--)!function(){var e=u.eq(p-1),t=e.attr("lay-done")||e.attr("lay-then"),a=n(e.attr("lay-url")||"").render(y),r=n(e.attr("lay-data")||"").render(y),s=n(e.attr("lay-headers")||"").render(y);try{r=new Function("return "+r+";")()}catch(d){o.error("lay-data: "+d.message),r={}}try{s=new Function("return "+s+";")()}catch(d){o.error("lay-headers: "+d.message),s=s||{}}a?i.req({type:e.attr("lay-type")||"get",url:a,data:r,dataType:"json",headers:s,success:function(n){c({dataElem:e,res:n,done:t})}}):c({dataElem:e,done:t})}();return s},d.prototype.send=function(e,t){var a=n(e||this.container.html()).render(t||{});return this.container.html(a),this},d.prototype.refresh=function(e){var t=this,n=t.container.next(),a=n.attr("lay-templateid");return t.id!=a?t:(t.parse(t.container,"refresh",function(){t.container.siblings('[lay-templateid="'+t.id+'"]:last').remove(),"function"==typeof e&&e()}),t)},d.prototype.then=function(e){return this.then=e,this},d.prototype.done=function(e){return this.done=e,this},e("view",i)});